<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supernova Financial Planning Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #FFFFFF;
            color: #1E1E1E;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(30, 30, 30, 0.08);
            overflow: hidden;
            margin-bottom: 30px;
            border: 1px solid #C0C0C0;
        }
        
        header {
            background: #FFFFFF;
            color: #1E1E1E;
            padding: 25px 30px;
            text-align: center;
            border-bottom: 2px solid #E22C6D;
            position: relative;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .logo-orbital {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #E22C6D 0%, #ff6b9d 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.8rem;
            position: relative;
        }
        
        .logo-orbital::before {
            content: '';
            position: absolute;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 2px dashed #C0C0C0;
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logo-text {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1E1E1E;
            letter-spacing: 0.5px;
        }
        
        .logo-text span {
            color: #E22C6D;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            color: #1E1E1E;
        }
        
        .page {
            display: none;
            padding: 30px;
        }
        
        .active-page {
            display: block;
        }
        
        .page-title {
            color: #1E1E1E;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 15px;
            margin-bottom: 25px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .page-title i {
            background-color: rgba(226, 44, 109, 0.1);
            padding: 10px;
            border-radius: 10px;
            color: #E22C6D;
        }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 2px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        
        .card:hover {
            transform: translateY(-5px);
            border-color: #E22C6D;
            box-shadow: 0 10px 25px rgba(226, 44, 109, 0.1);
        }
        
        .card-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .income-protection .card-icon {
            background-color: rgba(226, 44, 109, 0.1);
            color: #E22C6D;
        }
        
        .health-care .card-icon {
            background-color: rgba(226, 44, 109, 0.08);
            color: #E22C6D;
        }
        
        .education .card-icon {
            background-color: rgba(226, 44, 109, 0.12);
            color: #E22C6D;
        }
        
        .retirement .card-icon {
            background-color: rgba(226, 44, 109, 0.15);
            color: #E22C6D;
        }
        
        .card h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: #1E1E1E;
        }
        
        .card p {
            color: #666;
            font-size: 0.95rem;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1E1E1E;
            font-size: 1.1rem;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 14px;
            border: 2px solid #C0C0C0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
            color: #1E1E1E;
        }
        
        .form-group input:focus, .form-group select:focus {
            border-color: #E22C6D;
            outline: none;
        }
        
        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .radio-option {
            flex: 1;
            min-width: 120px;
        }
        
        .radio-option input {
            display: none;
        }
        
        .radio-option label {
            display: block;
            padding: 15px;
            background-color: #f8f9fa;
            border: 2px solid #C0C0C0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: normal;
            color: #1E1E1E;
        }
        
        .radio-option input:checked + label {
            background-color: rgba(226, 44, 109, 0.1);
            border-color: #E22C6D;
            color: #E22C6D;
            font-weight: 600;
        }
        
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 2px solid #f0f0f0;
        }
        
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-back {
            background-color: #f8f9fa;
            color: #555;
            border: 2px solid #C0C0C0;
        }
        
        .btn-back:hover {
            background-color: #e9ecef;
        }
        
        .btn-calculate {
            background: linear-gradient(to right, #E22C6D, #ff6b9d);
            color: white;
        }
        
        .btn-calculate:hover {
            background: linear-gradient(to right, #d12463, #E22C6D);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(226, 44, 109, 0.2);
        }
        
        .btn-new {
            background: linear-gradient(to right, #E22C6D, #ff6b9d);
            color: white;
            margin: 0 auto;
        }
        
        .btn-new:hover {
            background: linear-gradient(to right, #d12463, #E22C6D);
            transform: translateY(-2px);
        }
        
        .results-container {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            border-left: 5px solid #E22C6D;
        }
        
        .result-heading {
            font-size: 1.5rem;
            color: #1E1E1E;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: #1E1E1E;
        }
        
        .result-value {
            font-weight: 700;
            color: #E22C6D;
            font-size: 1.1rem;
        }
        
        .gap-highlight {
            background-color: rgba(226, 44, 109, 0.08);
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            border: 2px solid #E22C6D;
        }
        
        .gap-highlight .result-label {
            color: #E22C6D;
            font-size: 1.2rem;
        }
        
        .gap-highlight .result-value {
            color: #E22C6D;
            font-size: 1.5rem;
        }
        
        .calculation-note {
            background-color: rgba(226, 44, 109, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin-top: 25px;
            font-size: 0.9rem;
            color: #1E1E1E;
            border-left: 4px solid #E22C6D;
        }
        
        .advisor-notes {
            background-color: rgba(226, 44, 109, 0.08);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #1E1E1E;
            border-left: 4px solid #E22C6D;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-weight: 600;
            margin: 0 10px;
            position: relative;
        }
        
        .step.active {
            background-color: #E22C6D;
            color: white;
        }
        
        .step::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            width: 20px;
            height: 2px;
            background-color: #f0f0f0;
        }
        
        .step:last-child::after {
            display: none;
        }
        
        .monetary-input {
            text-align: right;
            font-weight: 500;
            padding-left: 40px;
        }
        
        .currency-container {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .currency-symbol {
            position: absolute;
            left: 15px;
            color: #666;
            font-weight: 500;
            z-index: 1;
            pointer-events: none;
        }
        
        @media (max-width: 768px) {
            .card-container {
                grid-template-columns: 1fr;
            }
            
            .radio-group {
                flex-direction: column;
            }
            
            .buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .logo-text {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo-orbital">
                    <i class="fas fa-star"></i>
                </div>
                <div class="logo-text">Supernova <span>Financial</span></div>
            </div>
            <p>Guide your clients through the fact-finding process and visualize their financial gaps</p>
        </header>
        
        <!-- Page 1: Planning Area Selection -->
        <div id="page1" class="page active-page">
            <h2 class="page-title"><i class="fas fa-compass"></i>Select Financial Planning Area</h2>
            <p style="margin-bottom: 25px; font-size: 1.1rem; color: #666;">Choose the area you'd like to explore with your client:</p>
            
            <div class="card-container">
                <div class="card income-protection" onclick="selectPlanningArea('income')">
                    <div class="card-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Income Protection</h3>
                    <p>Life insurance needs calculation using the income replacement method (10-15x annual income)</p>
                </div>
                
                <div class="card health-care" onclick="selectPlanningArea('health')">
                    <div class="card-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <h3>Health Care Funding</h3>
                    <p>Medical & critical illness coverage based on 1-3 years of annual income</p>
                </div>
                
                <div class="card education" onclick="selectPlanningArea('education')">
                    <div class="card-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h3>Education Funding</h3>
                    <p>Future cost projection for college education with 10% annual inflation</p>
                </div>
                
                <div class="card retirement" onclick="selectPlanningArea('retirement')">
                    <div class="card-icon">
                        <i class="fas fa-umbrella-beach"></i>
                    </div>
                    <h3>Retirement Planning</h3>
                    <p>Retirement fund calculation using the 20-25x rule for sustainable income</p>
                </div>
            </div>
            
            <div class="calculation-note">
                <i class="fas fa-lightbulb"></i> <strong>Advisor Tip:</strong> Use this tool during client conversations to make computations easier and provide a clear visual summary of their financial gaps.
            </div>
        </div>
        
        <!-- Page 2: Income Protection Form -->
        <div id="page-income" class="page">
            <div class="step-indicator">
                <div class="step active">1</div>
                <div class="step">2</div>
                <div class="step">3</div>
            </div>
            
            <h2 class="page-title"><i class="fas fa-shield-alt"></i>Income Protection Analysis</h2>
            
            <div class="form-group">
                <label for="monthly-income">What is your client's monthly income?</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="monthly-income" class="monetary-input" placeholder="e.g., 50,000" data-raw-value="">
                </div>
            </div>
            
            <div class="form-group">
                <label>How many years of income protection would your client prefer?</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="years-10" name="protection-years" value="10" checked>
                        <label for="years-10">10 Years</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="years-15" name="protection-years" value="15">
                        <label for="years-15">15 Years</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="existing-life">How much life insurance does your client already have?</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="existing-life" class="monetary-input" placeholder="e.g., 1,000,000" data-raw-value="">
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-back" onclick="goBackToSelection()">
                    <i class="fas fa-arrow-left"></i> Back to Selection
                </button>
                <button class="btn btn-calculate" onclick="calculateIncomeProtection()">
                    Calculate Gap <i class="fas fa-calculator"></i>
                </button>
            </div>
        </div>
        
        <!-- Page 3: Health Care Funding Form -->
        <div id="page-health" class="page">
            <div class="step-indicator">
                <div class="step active">1</div>
                <div class="step">2</div>
                <div class="step">3</div>
            </div>
            
            <h2 class="page-title"><i class="fas fa-heartbeat"></i>Health Care Funding Analysis</h2>
            
            <div class="form-group">
                <label for="annual-income-health">What is your client's annual income?</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="annual-income-health" class="monetary-input" placeholder="e.g., 600,000" data-raw-value="">
                </div>
            </div>
            
            <div class="form-group">
                <label>How many years of health fund coverage would your client prefer?</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="health-1" name="health-years" value="1">
                        <label for="health-1">1 Year (Basic)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="health-2" name="health-years" value="2" checked>
                        <label for="health-2">2 Years (Recommended)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="health-3" name="health-years" value="3">
                        <label for="health-3">3 Years (Comprehensive)</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="existing-health">Total existing health coverage (HMO, PhilHealth, CI plans)</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="existing-health" class="monetary-input" placeholder="e.g., 500,000" data-raw-value="">
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-back" onclick="goBackToSelection()">
                    <i class="fas fa-arrow-left"></i> Back to Selection
                </button>
                <button class="btn btn-calculate" onclick="calculateHealthCare()">
                    Calculate Gap <i class="fas fa-calculator"></i>
                </button>
            </div>
        </div>
        
        <!-- Page 4: Education Funding Form -->
        <div id="page-education" class="page">
            <div class="step-indicator">
                <div class="step active">1</div>
                <div class="step">2</div>
                <div class="step">3</div>
                <div class="step">4</div>
            </div>
            
            <h2 class="page-title"><i class="fas fa-graduation-cap"></i>Education Funding Analysis</h2>
            
            <div class="form-group">
                <label for="child-age">How old is your client's child? (Years)</label>
                <input type="number" id="child-age" placeholder="e.g., 8">
            </div>
            
            <div class="form-group">
                <label for="current-tuition">Current annual tuition for target college</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="current-tuition" class="monetary-input" placeholder="e.g., 150,000" data-raw-value="">
                </div>
            </div>
            
            <div class="form-group">
                <label>How many years will the college program take?</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="college-4" name="college-years" value="4" checked>
                        <label for="college-4">4 Years</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="college-5" name="college-years" value="5">
                        <label for="college-5">5 Years</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="existing-education">Current education savings/investments</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="existing-education" class="monetary-input" placeholder="e.g., 200,000" data-raw-value="">
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-back" onclick="goBackToSelection()">
                    <i class="fas fa-arrow-left"></i> Back to Selection
                </button>
                <button class="btn btn-calculate" onclick="calculateEducation()">
                    Calculate Gap <i class="fas fa-calculator"></i>
                </button>
            </div>
        </div>
        
        <!-- Page 5: Retirement Planning Form -->
        <div id="page-retirement" class="page">
            <div class="step-indicator">
                <div class="step active">1</div>
                <div class="step">2</div>
                <div class="step">3</div>
            </div>
            
            <h2 class="page-title"><i class="fas fa-umbrella-beach"></i>Retirement Planning Analysis</h2>
            
            <div class="form-group">
                <label for="monthly-retirement">Desired monthly retirement income (in today's pesos)</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="monthly-retirement" class="monetary-input" placeholder="e.g., 50,000" data-raw-value="">
                </div>
            </div>
            
            <div class="form-group">
                <label>Choose a retirement multiplier based on lifestyle goal</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="multiplier-20" name="retirement-multiplier" value="20">
                        <label for="multiplier-20">20× (Modest Retirement)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="multiplier-25" name="retirement-multiplier" value="25" checked>
                        <label for="multiplier-25">25× (Comfortable Retirement)</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="existing-retirement">Current retirement savings/investments</label>
                <div class="currency-container">
                    <span class="currency-symbol">₱</span>
                    <input type="text" id="existing-retirement" class="monetary-input" placeholder="e.g., 1,000,000" data-raw-value="">
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-back" onclick="goBackToSelection()">
                    <i class="fas fa-arrow-left"></i> Back to Selection
                </button>
                <button class="btn btn-calculate" onclick="calculateRetirement()">
                    Calculate Gap <i class="fas fa-calculator"></i>
                </button>
            </div>
        </div>
        
        <!-- Results Page -->
        <div id="page-results" class="page">
            <h2 class="page-title"><i class="fas fa-chart-bar"></i>Financial Gap Analysis Results</h2>
            
            <div id="results-container" class="results-container">
                <!-- Results will be dynamically inserted here -->
            </div>
            
            <div class="buttons" style="justify-content: center;">
                <button class="btn btn-new" onclick="goBackToSelection()">
                    <i class="fas fa-redo"></i> Start New Analysis
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentPlanningArea = '';
        
        // Format number with commas
        function formatNumberWithCommas(num) {
            if (!num && num !== 0) return '';
            // Remove any existing commas and non-digit characters except decimal point
            const numStr = num.toString().replace(/[^\d.]/g, '');
            if (numStr === '') return '';
            
            // Split into integer and decimal parts
            const parts = numStr.split('.');
            let integerPart = parts[0];
            const decimalPart = parts.length > 1 ? '.' + parts[1] : '';
            
            // Add commas to integer part
            integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            
            return integerPart + decimalPart;
        }
        
        // Parse formatted number (with commas) back to a number
        function parseFormattedNumber(formattedNum) {
            if (!formattedNum) return 0;
            // Remove commas and any non-digit characters except decimal point
            const numStr = formattedNum.replace(/[^\d.]/g, '');
            return parseFloat(numStr) || 0;
        }
        
        // Add event listeners for monetary input formatting
        document.addEventListener('DOMContentLoaded', function() {
            // Add input event listeners to all monetary inputs
            document.querySelectorAll('.monetary-input').forEach(input => {
                // Format on input
                input.addEventListener('input', function() {
                    const cursorPosition = this.selectionStart;
                    const formattedValue = formatNumberWithCommas(this.value);
                    
                    // Update the input value
                    this.value = formattedValue;
                    
                    // Store the raw value in data attribute
                    this.dataset.rawValue = parseFormattedNumber(formattedValue);
                    
                    // Restore cursor position (adjust for added commas)
                    const newCursorPosition = cursorPosition + (formattedValue.length - this.value.length);
                    this.setSelectionRange(newCursorPosition, newCursorPosition);
                });
                
                // Format on blur (in case user pastes content)
                input.addEventListener('blur', function() {
                    this.value = formatNumberWithCommas(this.value);
                    this.dataset.rawValue = parseFormattedNumber(this.value);
                });
                
                // Format on initial load if there's a value
                if (input.value) {
                    input.value = formatNumberWithCommas(input.value);
                    input.dataset.rawValue = parseFormattedNumber(input.value);
                }
            });
        });
        
        function selectPlanningArea(area) {
            currentPlanningArea = area;
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            
            // Show the selected planning area page
            document.getElementById(`page-${area}`).classList.add('active-page');
        }
        
        function goBackToSelection() {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            
            // Show the selection page
            document.getElementById('page1').classList.add('active-page');
            
            // Clear any input fields
            clearInputs();
        }
        
        function clearInputs() {
            // Clear all input fields
            document.querySelectorAll('input[type="text"], input[type="number"]').forEach(input => {
                input.value = '';
                if (input.dataset.rawValue !== undefined) {
                    input.dataset.rawValue = '';
                }
            });
            
            // Reset radio buttons to default
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                if (radio.id === 'years-10' || radio.id === 'health-2' || 
                    radio.id === 'college-4' || radio.id === 'multiplier-25') {
                    radio.checked = true;
                } else {
                    radio.checked = false;
                }
            });
        }
        
        // Get raw value from monetary input
        function getMonetaryValue(inputId) {
            const input = document.getElementById(inputId);
            if (input && input.dataset.rawValue) {
                return parseFloat(input.dataset.rawValue) || 0;
            }
            return parseFormattedNumber(input.value) || 0;
        }
        
        function calculateIncomeProtection() {
            // Get values from form using the raw values
            const monthlyIncome = getMonetaryValue('monthly-income');
            const existingLife = getMonetaryValue('existing-life');
            
            // Get selected protection years
            const protectionYears = parseInt(document.querySelector('input[name="protection-years"]:checked').value);
            
            // Validate inputs
            if (!monthlyIncome || monthlyIncome <= 0) {
                alert('Please enter a valid monthly income.');
                return;
            }
            
            // Calculate annual income
            const annualIncome = monthlyIncome * 12;
            
            // Calculate target coverage
            const targetCoverage = annualIncome * protectionYears;
            
            // Calculate gap
            const gap = targetCoverage - existingLife;
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-shield-alt"></i> Income Protection Gap Analysis
                </div>
                
                <div class="result-item">
                    <span class="result-label">Monthly Income:</span>
                    <span class="result-value">${formatNumber(monthlyIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Annual Income:</span>
                    <span class="result-value">${formatNumber(annualIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Protection Period:</span>
                    <span class="result-value">${protectionYears} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Target Coverage (${protectionYears}x annual income):</span>
                    <span class="result-value">${formatNumber(targetCoverage)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Existing Life Insurance:</span>
                    <span class="result-value">${formatNumber(existingLife)}</span>
                </div>
                
                <div class="gap-highlight">
                    <div class="result-item">
                        <span class="result-label">Income Protection Gap:</span>
                        <span class="result-value">${formatNumber(gap)}</span>
                    </div>
                </div>
                
                <div class="advisor-notes">
                    <i class="fas fa-lightbulb"></i> <strong>Advisor Notes:</strong> ${protectionYears}x annual income is ${protectionYears === 10 ? 'a common minimum benchmark' : 'ideal for young families'}. Choose the replacement years based on how long the family would financially struggle without the breadwinner.
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Income Protection');
        }
        
        function calculateHealthCare() {
            // Get values from form
            const annualIncome = getMonetaryValue('annual-income-health');
            const existingHealth = getMonetaryValue('existing-health');
            
            // Get selected health years
            const healthYears = parseInt(document.querySelector('input[name="health-years"]:checked').value);
            
            // Validate inputs
            if (!annualIncome || annualIncome <= 0) {
                alert('Please enter a valid annual income.');
                return;
            }
            
            // Calculate target health fund
            const targetHealthFund = annualIncome * healthYears;
            
            // Calculate gap
            const gap = targetHealthFund - existingHealth;
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-heartbeat"></i> Health Care Funding Gap Analysis
                </div>
                
                <div class="result-item">
                    <span class="result-label">Annual Income:</span>
                    <span class="result-value">${formatNumber(annualIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Coverage Target:</span>
                    <span class="result-value">${healthYears} Year${healthYears > 1 ? 's' : ''} of Income</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Target Health Fund (${healthYears}x annual income):</span>
                    <span class="result-value">${formatNumber(targetHealthFund)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Existing Health Coverage:</span>
                    <span class="result-value">${formatNumber(existingHealth)}</span>
                </div>
                
                <div class="gap-highlight">
                    <div class="result-item">
                        <span class="result-label">Health Care Funding Gap:</span>
                        <span class="result-value">${formatNumber(gap)}</span>
                    </div>
                </div>
                
                <div class="advisor-notes">
                    <i class="fas fa-lightbulb"></i> <strong>Advisor Notes:</strong> The target fund represents the cost of treatment plus income replacement during recovery. Use higher multipliers for clients with dependents or family history of illness. HMO + PhilHealth alone is not designed for long-term treatment or income loss.
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Health Care Funding');
        }
        
        function calculateEducation() {
            // Get values from form
            const childAge = parseFloat(document.getElementById('child-age').value);
            const currentTuition = getMonetaryValue('current-tuition');
            const existingEducation = getMonetaryValue('existing-education');
            
            // Get selected college years
            const collegeYears = parseInt(document.querySelector('input[name="college-years"]:checked').value);
            
            // Validate inputs
            if (!childAge || childAge <= 0) {
                alert('Please enter a valid child age.');
                return;
            }
            
            if (!currentTuition || currentTuition <= 0) {
                alert('Please enter a valid current tuition amount.');
                return;
            }
            
            // Calculate years until college (assuming college starts at age 18)
            const yearsUntilCollege = 18 - childAge;
            
            if (yearsUntilCollege <= 0) {
                alert('Child is already at or past college age. Please adjust the calculation.');
                return;
            }
            
            // Calculate future annual tuition with 10% inflation
            const futureAnnualTuition = currentTuition * Math.pow(1.10, yearsUntilCollege);
            
            // Calculate total education fund needed
            const educationFundNeeded = futureAnnualTuition * collegeYears;
            
            // Calculate gap
            const gap = educationFundNeeded - existingEducation;
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-graduation-cap"></i> Education Funding Gap Analysis
                </div>
                
                <div class="result-item">
                    <span class="result-label">Child's Current Age:</span>
                    <span class="result-value">${childAge} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Years Until College:</span>
                    <span class="result-value">${yearsUntilCollege} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Current Annual Tuition:</span>
                    <span class="result-value">${formatNumber(currentTuition)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Future Annual Tuition (with 10% inflation):</span>
                    <span class="result-value">${formatNumber(futureAnnualTuition)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">College Duration:</span>
                    <span class="result-value">${collegeYears} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Total Education Fund Needed:</span>
                    <span class="result-value">${formatNumber(educationFundNeeded)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Current Education Savings:</span>
                    <span class="result-value">${formatNumber(existingEducation)}</span>
                </div>
                
                <div class="gap-highlight">
                    <div class="result-item">
                        <span class="result-label">Education Funding Gap:</span>
                        <span class="result-value">${formatNumber(gap)}</span>
                    </div>
                </div>
                
                <div class="advisor-notes">
                    <i class="fas fa-lightbulb"></i> <strong>Advisor Notes:</strong> Inflation matters—today's tuition will not be the same in ${yearsUntilCollege} years. Emphasize that parents don't need to fund 100% immediately; what matters is starting early while time is still on their side.
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Education Funding');
        }
        
        function calculateRetirement() {
            // Get values from form
            const monthlyRetirement = getMonetaryValue('monthly-retirement');
            const existingRetirement = getMonetaryValue('existing-retirement');
            
            // Get selected multiplier
            const multiplier = parseInt(document.querySelector('input[name="retirement-multiplier"]:checked').value);
            
            // Validate inputs
            if (!monthlyRetirement || monthlyRetirement <= 0) {
                alert('Please enter a valid monthly retirement income.');
                return;
            }
            
            // Calculate annual retirement income
            const annualRetirementIncome = monthlyRetirement * 12;
            
            // Calculate target retirement fund
            const targetRetirementFund = annualRetirementIncome * multiplier;
            
            // Calculate gap
            const gap = targetRetirementFund - existingRetirement;
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-umbrella-beach"></i> Retirement Planning Gap Analysis
                </div>
                
                <div class="result-item">
                    <span class="result-label">Desired Monthly Retirement Income:</span>
                    <span class="result-value">${formatNumber(monthlyRetirement)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Annual Retirement Income:</span>
                    <span class="result-value">${formatNumber(annualRetirementIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Retirement Multiplier:</span>
                    <span class="result-value">${multiplier}x</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Target Retirement Fund (${multiplier}x annual income):</span>
                    <span class="result-value">${formatNumber(targetRetirementFund)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Current Retirement Savings:</span>
                    <span class="result-value">${formatNumber(existingRetirement)}</span>
                </div>
                
                <div class="gap-highlight">
                    <div class="result-item">
                        <span class="result-label">Retirement Planning Gap:</span>
                        <span class="result-value">${formatNumber(gap)}</span>
                    </div>
                </div>
                
                <div class="advisor-notes">
                    <i class="fas fa-lightbulb"></i> <strong>Advisor Notes:</strong> This multiplier assumes the 4% safe withdrawal rule. Emphasize that the goal is to maintain their lifestyle even after they stop working. Starting early gives the best chance at a dignified retirement.
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Retirement Planning');
        }
        
        function showResults(resultsHTML, planningArea) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            
            // Set results title
            document.querySelector('#page-results .page-title i').className = getAreaIcon(planningArea);
            document.querySelector('#page-results .page-title').innerHTML = `<i class="${getAreaIcon(planningArea)}"></i> ${planningArea} Gap Analysis`;
            
            // Insert results into container
            document.getElementById('results-container').innerHTML = resultsHTML;
            
            // Show results page
            document.getElementById('page-results').classList.add('active-page');
        }
        
        function getAreaIcon(planningArea) {
            switch(planningArea) {
                case 'Income Protection': return 'fas fa-shield-alt';
                case 'Health Care Funding': return 'fas fa-heartbeat';
                case 'Education Funding': return 'fas fa-graduation-cap';
                case 'Retirement Planning': return 'fas fa-umbrella-beach';
                default: return 'fas fa-chart-bar';
            }
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set focus on the first input of each form when page is shown
            document.querySelectorAll('.page').forEach(page => {
                if (page.id !== 'page1' && page.id !== 'page-results') {
                    const firstInput = page.querySelector('input[type="text"], input[type="number"]');
                    if (firstInput) {
                        // Add focus event when page becomes active
                        const observer = new MutationObserver(function(mutations) {
                            mutations.forEach(function(mutation) {
                                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                                    if (page.classList.contains('active-page')) {
                                        firstInput.focus();
                                    }
                                }
                            });
                        });
                        
                        observer.observe(page, { attributes: true });
                    }
                }
            });
        });
    </script>
</body>
</html>
