<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Supernova Financial Planning Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        body {
            background-color: #FFFFFF;
            color: #1E1E1E;
            line-height: 1.5;
            padding: 0;
            margin: 0;
            min-height: 100vh;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }
        
        .container {
            background-color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        header {
            background: #FFFFFF;
            color: #1E1E1E;
            padding: 20px 16px;
            text-align: center;
            border-bottom: 2px solid #E22C6D;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(30, 30, 30, 0.05);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            gap: 12px;
        }
        
        .logo-orbital {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #E22C6D 0%, #ff6b9d 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
            position: relative;
            flex-shrink: 0;
        }
        
        .logo-orbital::before {
            content: '';
            position: absolute;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 2px dashed #C0C0C0;
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logo-text {
            font-size: 1.6rem;
            font-weight: 700;
            color: #1E1E1E;
            letter-spacing: 0.3px;
            line-height: 1.2;
        }
        
        .logo-text span {
            color: #E22C6D;
        }

        .logo-image {
            max-width: 160px;      /* caps how wide it can get */
            max-height: 60px;      /* caps how tall it can get */
            width: auto;
            height: auto;
            display: block;
            object-fit: contain;
        }
        
        header p {
            font-size: 0.95rem;
            opacity: 0.9;
            margin: 0 auto;
            color: #1E1E1E;
            max-width: 90%;
        }
        
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 20px;
        }
        
        .page {
            display: none;
            width: 100%;
        }
        
        .active-page {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .page-content {
            padding: 20px 16px;
        }
        
        .page-title {
            color: #1E1E1E;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .page-title i {
            background-color: rgba(226, 44, 109, 0.1);
            padding: 8px;
            border-radius: 8px;
            color: #E22C6D;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .card-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 20px 0;
        }
        
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            border: 2px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            display: flex;
            align-items: flex-start;
            gap: 16px;
        }
        
        .card:active {
            transform: scale(0.98);
            border-color: #E22C6D;
            box-shadow: 0 6px 16px rgba(226, 44, 109, 0.1);
        }
        
        .card:hover {
            border-color: #E22C6D;
            box-shadow: 0 6px 16px rgba(226, 44, 109, 0.1);
        }
        
        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            flex-shrink: 0;
        }
        
        .income-protection .card-icon {
            background-color: rgba(226, 44, 109, 0.1);
            color: #E22C6D;
        }
        
        .health-care .card-icon {
            background-color: rgba(226, 44, 109, 0.08);
            color: #E22C6D;
        }
        
        .education .card-icon {
            background-color: rgba(226, 44, 109, 0.12);
            color: #E22C6D;
        }
        
        .retirement .card-icon {
            background-color: rgba(226, 44, 109, 0.15);
            color: #E22C6D;
        }
        
        .card-content {
            flex: 1;
        }
        
        .card h3 {
            font-size: 1.2rem;
            margin-bottom: 6px;
            color: #1E1E1E;
        }
        
        .card p {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1E1E1E;
            font-size: 1rem;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 16px;
            border: 2px solid #C0C0C0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
            color: #1E1E1E;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .form-group input:focus, .form-group select:focus {
            border-color: #E22C6D;
            outline: none;
        }
        
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 8px;
        }
        
        .radio-option {
            width: 100%;
        }
        
        .radio-option input {
            display: none;
        }
        
        .radio-option label {
            display: block;
            padding: 16px;
            background-color: #f8f9fa;
            border: 2px solid #C0C0C0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: normal;
            color: #1E1E1E;
            font-size: 1rem;
        }
        
        .radio-option input:checked + label {
            background-color: rgba(226, 44, 109, 0.1);
            border-color: #E22C6D;
            color: #E22C6D;
            font-weight: 600;
        }
        
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
            position: sticky;
            bottom: 0;
            background: white;
            padding-bottom: 10px;
        }
        
        .btn {
            padding: 18px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-align: center;
            min-height: 56px;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-back {
            background-color: #f8f9fa;
            color: #555;
            border: 2px solid #C0C0C0;
            order: 2;
        }
        
        .btn-calculate {
            background: linear-gradient(to right, #E22C6D, #ff6b9d);
            color: white;
            order: 1;
        }
        
        .btn-new {
            background: linear-gradient(to right, #E22C6D, #ff6b9d);
            color: white;
            margin-top: 10px;
        }
        
        .btn-new:active {
            background: linear-gradient(to right, #d12463, #E22C6D);
            transform: scale(0.98);
        }
        
        .results-container {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #E22C6D;
        }
        
        .result-heading {
            font-size: 1.3rem;
            color: #1E1E1E;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: #1E1E1E;
            font-size: 0.95rem;
            flex: 1;
        }
        
        .result-value {
            font-weight: 700;
            color: #E22C6D;
            font-size: 1rem;
            text-align: right;
            flex: 1;
        }
        
        .gap-highlight {
            background-color: rgba(226, 44, 109, 0.08);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #E22C6D;
        }
        
        .surplus-highlight {
            background-color: rgba(46, 204, 113, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #2ecc71;
        }
        
        .gap-highlight .result-label,
        .gap-highlight .result-value {
            color: #E22C6D;
            font-size: 1.1rem;
        }
        
        .surplus-highlight .result-label,
        .surplus-highlight .result-value {
            color: #27ae60;
            font-size: 1.1rem;
        }
        
        .gap-highlight .result-value {
            font-size: 1.3rem;
        }
        
        .surplus-highlight .result-value {
            font-size: 1.3rem;
        }
        
        .calculation-note {
            background-color: rgba(226, 44, 109, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #1E1E1E;
            border-left: 4px solid #E22C6D;
        }
        
        .advisor-notes {
            background-color: rgba(226, 44, 109, 0.08);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #1E1E1E;
            border-left: 4px solid #E22C6D;
        }
        
        .surplus-notes {
            background-color: rgba(46, 204, 113, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #1E1E1E;
            border-left: 4px solid #2ecc71;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
        }
        
        .step {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-weight: 600;
            margin: 0 8px;
            position: relative;
            font-size: 0.9rem;
        }
        
        .step.active {
            background-color: #E22C6D;
            color: white;
        }
        
        .step::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            width: 16px;
            height: 2px;
            background-color: #f0f0f0;
        }
        
        .step:last-child::after {
            display: none;
        }
        
        .monetary-input {
            text-align: right;
            font-weight: 500;
            padding-left: 40px;
        }
        
        .currency-container {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .currency-symbol {
            position: absolute;
            left: 16px;
            color: #666;
            font-weight: 500;
            z-index: 1;
            pointer-events: none;
            font-size: 1rem;
        }
        
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        /* Desktop improvements */
        @media (min-width: 768px) {
            body {
                padding: 20px;
                background-color: #f5f7fa;
            }
            
            .container {
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(30, 30, 30, 0.08);
                border: 1px solid #C0C0C0;
                max-width: 800px;
                margin: 0 auto;
                min-height: auto;
                max-height: 90vh;
                overflow: hidden;
            }
            
            .main-content {
                overflow-y: auto;
                max-height: calc(90vh - 120px);
            }
            
            header {
                position: static;
                padding: 25px 30px;
            }
            
            .logo-container {
                margin-bottom: 15px;
            }
            
            .logo-orbital {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .logo-orbital::before {
                width: 70px;
                height: 70px;
            }
            
            .logo-text {
                font-size: 2.2rem;
            }
            
            header p {
                font-size: 1.1rem;
            }
            
            .page-content {
                padding: 30px;
            }
            
            .page-title {
                font-size: 1.8rem;
                margin-bottom: 25px;
            }
            
            .card-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
                margin: 30px 0;
            }
            
            .card {
                flex-direction: column;
                text-align: center;
                gap: 20px;
                padding: 25px;
            }
            
            .card-icon {
                width: 70px;
                height: 70px;
                border-radius: 50%;
                margin: 0 auto;
                font-size: 1.8rem;
            }
            
            .card h3 {
                font-size: 1.4rem;
            }
            
            .card p {
                font-size: 0.95rem;
            }
            
            .radio-group {
                flex-direction: row;
                gap: 15px;
            }
            
            .radio-option {
                flex: 1;
                min-width: 120px;
            }
            
            .buttons {
                flex-direction: row;
                justify-content: space-between;
                gap: 15px;
                position: static;
                padding-bottom: 0;
            }
            
            .btn {
                flex: 1;
                min-height: auto;
                padding: 14px 20px;
            }
            
            .btn-back {
                order: 1;
            }
            
            .btn-calculate {
                order: 2;
            }
            
            .btn-new {
                max-width: 300px;
                margin: 30px auto 0;
            }
        }
        
        /* Large mobile/tablet */
        @media (min-width: 480px) and (max-width: 767px) {
            .card-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .card {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .card-icon {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                margin: 0 auto;
            }
            
            .radio-group {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .radio-option {
                flex: 1;
                min-width: 140px;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 359px) {
            .logo-container {
                flex-direction: column;
                gap: 8px;
            }
            
            .logo-text {
                font-size: 1.4rem;
            }
            
            .page-title {
                font-size: 1.3rem;
            }
            
            .card {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .card-icon {
                width: 50px;
                height: 50px;
                margin: 0 auto;
            }
        }
        
        /* iOS Safari specific fixes */
        @supports (-webkit-touch-callout: none) {
            .btn, .card {
                cursor: default;
            }
            
            input, select {
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <img src="spnv-center.png" alt="Supernova Financial" class="logo-image">
            </div>
            <p>Financial planning calculator for client conversations</p>
        </header>
        
        <div class="main-content">
            <!-- Page 1: Planning Area Selection -->
            <div id="page1" class="page active-page">
                <div class="page-content">
                    <h2 class="page-title"><i class="fas fa-compass"></i>Select Planning Area</h2>
                    <p style="margin-bottom: 20px; font-size: 1rem; color: #666;">Choose the financial area to explore with your client:</p>
                    
                    <div class="card-container">
                        <div class="card income-protection" onclick="selectPlanningArea('income')">
                            <div class="card-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="card-content">
                                <h3>Income Protection</h3>
                                <p>Life insurance needs (10-15x annual income)</p>
                            </div>
                        </div>
                        
                        <div class="card health-care" onclick="selectPlanningArea('health')">
                            <div class="card-icon">
                                <i class="fas fa-heartbeat"></i>
                            </div>
                            <div class="card-content">
                                <h3>Health Care Funding</h3>
                                <p>Medical coverage (1-3 years of income)</p>
                            </div>
                        </div>
                        
                        <div class="card education" onclick="selectPlanningArea('education')">
                            <div class="card-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <div class="card-content">
                                <h3>Education Funding</h3>
                                <p>College cost projection with 10% inflation</p>
                            </div>
                        </div>
                        
                        <div class="card retirement" onclick="selectPlanningArea('retirement')">
                            <div class="card-icon">
                                <i class="fas fa-umbrella-beach"></i>
                            </div>
                            <div class="card-content">
                                <h3>Retirement Planning</h3>
                                <p>Retirement fund (20-25x rule)</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="calculation-note">
                        <i class="fas fa-lightbulb"></i> <strong>Advisor Tip:</strong> Use this tool during client conversations to make computations easier and visualize financial gaps.
                    </div>
                </div>
            </div>
            
            <!-- Page 2: Income Protection Form -->
            <div id="page-income" class="page">
                <div class="page-content">
                    <div class="step-indicator">
                        <div class="step active">1</div>
                        <div class="step">2</div>
                        <div class="step">3</div>
                    </div>
                    
                    <h2 class="page-title"><i class="fas fa-shield-alt"></i>Income Protection</h2>
                    
                    <div class="form-group">
                        <label for="monthly-income">Client's monthly income</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="monthly-income" class="monetary-input" placeholder="e.g., 50,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Years of income protection preferred</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="years-10" name="protection-years" value="10" checked>
                                <label for="years-10">10 Years</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="years-15" name="protection-years" value="15">
                                <label for="years-15">15 Years</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="existing-life">Existing life insurance coverage</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="existing-life" class="monetary-input" placeholder="e.g., 1,000,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="btn btn-back" onclick="goBackToSelection()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-calculate" onclick="calculateIncomeProtection()">
                            Calculate Gap <i class="fas fa-calculator"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Page 3: Health Care Funding Form -->
            <div id="page-health" class="page">
                <div class="page-content">
                    <div class="step-indicator">
                        <div class="step active">1</div>
                        <div class="step">2</div>
                        <div class="step">3</div>
                    </div>
                    
                    <h2 class="page-title"><i class="fas fa-heartbeat"></i>Health Care Funding</h2>
                    
                    <div class="form-group">
                        <label for="annual-income-health">Client's annual income</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="annual-income-health" class="monetary-input" placeholder="e.g., 600,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Health fund coverage preference</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="health-1" name="health-years" value="1">
                                <label for="health-1">1 Year (Basic)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="health-2" name="health-years" value="2" checked>
                                <label for="health-2">2 Years (Recommended)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="health-3" name="health-years" value="3">
                                <label for="health-3">3 Years (Comprehensive)</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="existing-health">Existing health coverage (HMO, PhilHealth, CI)</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="existing-health" class="monetary-input" placeholder="e.g., 500,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="btn btn-back" onclick="goBackToSelection()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-calculate" onclick="calculateHealthCare()">
                            Calculate Gap <i class="fas fa-calculator"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Page 4: Education Funding Form -->
            <div id="page-education" class="page">
                <div class="page-content">
                    <div class="step-indicator">
                        <div class="step active">1</div>
                        <div class="step">2</div>
                        <div class="step">3</div>
                        <div class="step">4</div>
                    </div>
                    
                    <h2 class="page-title"><i class="fas fa-graduation-cap"></i>Education Funding</h2>
                    
                    <div class="form-group">
                        <label for="child-age">Child's current age (years)</label>
                        <input type="number" id="child-age" placeholder="e.g., 8" inputmode="numeric" min="0" max="18">
                    </div>
                    
                    <div class="form-group">
                        <label for="current-tuition">Current annual college tuition</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="current-tuition" class="monetary-input" placeholder="e.g., 150,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>College program duration</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="college-4" name="college-years" value="4" checked>
                                <label for="college-4">4 Years</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="college-5" name="college-years" value="5">
                                <label for="college-5">5 Years</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="existing-education">Current education savings</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="existing-education" class="monetary-input" placeholder="e.g., 200,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="btn btn-back" onclick="goBackToSelection()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-calculate" onclick="calculateEducation()">
                            Calculate Gap <i class="fas fa-calculator"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Page 5: Retirement Planning Form -->
            <div id="page-retirement" class="page">
                <div class="page-content">
                    <div class="step-indicator">
                        <div class="step active">1</div>
                        <div class="step">2</div>
                        <div class="step">3</div>
                    </div>
                    
                    <h2 class="page-title"><i class="fas fa-umbrella-beach"></i>Retirement Planning</h2>
                    
                    <div class="form-group">
                        <label for="monthly-retirement">Desired monthly retirement income</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="monthly-retirement" class="monetary-input" placeholder="e.g., 50,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Retirement multiplier</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="multiplier-20" name="retirement-multiplier" value="20">
                                <label for="multiplier-20">20× (Modest)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="multiplier-25" name="retirement-multiplier" value="25" checked>
                                <label for="multiplier-25">25× (Comfortable)</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="existing-retirement">Current retirement savings</label>
                        <div class="currency-container">
                            <span class="currency-symbol">₱</span>
                            <input type="text" id="existing-retirement" class="monetary-input" placeholder="e.g., 1,000,000" data-raw-value="" inputmode="numeric">
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="btn btn-back" onclick="goBackToSelection()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-calculate" onclick="calculateRetirement()">
                            Calculate Gap <i class="fas fa-calculator"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Results Page -->
            <div id="page-results" class="page">
                <div class="page-content">
                    <h2 class="page-title"><i class="fas fa-chart-bar"></i>Results Summary</h2>
                    
                    <div id="results-container" class="results-container">
                        <!-- Results will be dynamically inserted here -->
                    </div>
                    
                    <div class="buttons" style="border-top: none; padding-top: 0;">
                        <button class="btn btn-new" onclick="goBackToSelection()">
                            <i class="fas fa-redo"></i> New Analysis
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPlanningArea = '';
        
        // Format number with commas
        function formatNumberWithCommas(num) {
            if (!num && num !== 0) return '';
            // Remove any existing commas and non-digit characters except decimal point
            const numStr = num.toString().replace(/[^\d.]/g, '');
            if (numStr === '') return '';
            
            // Split into integer and decimal parts
            const parts = numStr.split('.');
            let integerPart = parts[0];
            const decimalPart = parts.length > 1 ? '.' + parts[1] : '';
            
            // Add commas to integer part
            integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            
            return integerPart + decimalPart;
        }
        
        // Parse formatted number (with commas) back to a number
        function parseFormattedNumber(formattedNum) {
            if (!formattedNum) return 0;
            // Remove commas and any non-digit characters except decimal point
            const numStr = formattedNum.replace(/[^\d.]/g, '');
            return parseFloat(numStr) || 0;
        }
        
        // Add event listeners for monetary input formatting
        document.addEventListener('DOMContentLoaded', function() {
            // Add input event listeners to all monetary inputs
            document.querySelectorAll('.monetary-input').forEach(input => {
                // Format on input
                input.addEventListener('input', function() {
                    const cursorPosition = this.selectionStart;
                    const formattedValue = formatNumberWithCommas(this.value);
                    
                    // Update the input value
                    this.value = formattedValue;
                    
                    // Store the raw value in data attribute
                    this.dataset.rawValue = parseFormattedNumber(formattedValue);
                    
                    // Restore cursor position (adjust for added commas)
                    const newCursorPosition = cursorPosition + (formattedValue.length - this.value.length);
                    this.setSelectionRange(newCursorPosition, newCursorPosition);
                });
                
                // Format on blur (in case user pastes content)
                input.addEventListener('blur', function() {
                    this.value = formatNumberWithCommas(this.value);
                    this.dataset.rawValue = parseFormattedNumber(this.value);
                });
                
                // Format on initial load if there's a value
                if (input.value) {
                    input.value = formatNumberWithCommas(input.value);
                    input.dataset.rawValue = parseFormattedNumber(input.value);
                }
            });
            
            // Prevent form submission on enter key in inputs
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        // Find the calculate button and click it
                        const calculateBtn = this.closest('.page-content').querySelector('.btn-calculate');
                        if (calculateBtn) calculateBtn.click();
                    }
                });
            });
        });
        
        function selectPlanningArea(area) {
            currentPlanningArea = area;
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            
            // Show the selected planning area page
            document.getElementById(`page-${area}`).classList.add('active-page');
            
            // Scroll to top
            document.querySelector('.main-content').scrollTop = 0;
        }
        
        function goBackToSelection() {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            
            // Show the selection page
            document.getElementById('page1').classList.add('active-page');
            
            // Clear any input fields
            clearInputs();
            
            // Scroll to top
            document.querySelector('.main-content').scrollTop = 0;
        }
        
        function clearInputs() {
            // Clear all input fields
            document.querySelectorAll('input[type="text"], input[type="number"]').forEach(input => {
                input.value = '';
                if (input.dataset.rawValue !== undefined) {
                    input.dataset.rawValue = '';
                }
            });
            
            // Reset radio buttons to default
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                if (radio.id === 'years-10' || radio.id === 'health-2' || 
                    radio.id === 'college-4' || radio.id === 'multiplier-25') {
                    radio.checked = true;
                } else {
                    radio.checked = false;
                }
            });
        }
        
        // Get raw value from monetary input
        function getMonetaryValue(inputId) {
            const input = document.getElementById(inputId);
            if (input && input.dataset.rawValue) {
                return parseFloat(input.dataset.rawValue) || 0;
            }
            return parseFormattedNumber(input.value) || 0;
        }
        
        function calculateIncomeProtection() {
            // Get values from form using the raw values
            const monthlyIncome = getMonetaryValue('monthly-income');
            const existingLife = getMonetaryValue('existing-life');
            
            // Get selected protection years
            const protectionYears = parseInt(document.querySelector('input[name="protection-years"]:checked').value);
            
            // Validate inputs
            if (!monthlyIncome || monthlyIncome <= 0) {
                alert('Please enter a valid monthly income.');
                return;
            }
            
            // Calculate annual income
            const annualIncome = monthlyIncome * 12;
            
            // Calculate target coverage
            const targetCoverage = annualIncome * protectionYears;
            
            // Calculate gap
            const gap = targetCoverage - existingLife;
            const isSurplus = gap < 0;
            const gapAmount = Math.abs(gap);
            const gapLabel = isSurplus ? 'Protection Surplus' : 'Protection Gap';
            const gapClass = isSurplus ? 'surplus-highlight' : 'gap-highlight';
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 0, maximumFractionDigits: 0});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-shield-alt"></i> Income Protection ${isSurplus ? 'Surplus' : 'Gap'}
                </div>
                
                <div class="result-item">
                    <span class="result-label">Monthly Income:</span>
                    <span class="result-value">${formatNumber(monthlyIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Annual Income:</span>
                    <span class="result-value">${formatNumber(annualIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Protection Period:</span>
                    <span class="result-value">${protectionYears} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Target Coverage:</span>
                    <span class="result-value">${formatNumber(targetCoverage)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Existing Coverage:</span>
                    <span class="result-value">${formatNumber(existingLife)}</span>
                </div>
                
                <div class="${gapClass}">
                    <div class="result-item">
                        <span class="result-label">${gapLabel}:</span>
                        <span class="result-value">${formatNumber(gapAmount)}</span>
                    </div>
                </div>
                
                <div class="${isSurplus ? 'surplus-notes' : 'advisor-notes'}">
                    <i class="fas fa-lightbulb"></i> <strong>${isSurplus ? 'Great News!' : 'Advisor Notes:'}</strong> ${isSurplus ? 
                    'Your client already exceeds the recommended coverage by ' + formatNumber(gapAmount) + '! This provides excellent financial security for their family.' : 
                    protectionYears + 'x annual income is ' + (protectionYears === 10 ? 'a common minimum benchmark' : 'ideal for young families') + '. This ensures family financial stability if income stops.'}
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Income Protection');
        }
        
        function calculateHealthCare() {
            // Get values from form
            const annualIncome = getMonetaryValue('annual-income-health');
            const existingHealth = getMonetaryValue('existing-health');
            
            // Get selected health years
            const healthYears = parseInt(document.querySelector('input[name="health-years"]:checked').value);
            
            // Validate inputs
            if (!annualIncome || annualIncome <= 0) {
                alert('Please enter a valid annual income.');
                return;
            }
            
            // Calculate target health fund
            const targetHealthFund = annualIncome * healthYears;
            
            // Calculate gap
            const gap = targetHealthFund - existingHealth;
            const isSurplus = gap < 0;
            const gapAmount = Math.abs(gap);
            const gapLabel = isSurplus ? 'Health Care Surplus' : 'Health Care Gap';
            const gapClass = isSurplus ? 'surplus-highlight' : 'gap-highlight';
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 0, maximumFractionDigits: 0});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-heartbeat"></i> Health Care Funding ${isSurplus ? 'Surplus' : 'Gap'}
                </div>
                
                <div class="result-item">
                    <span class="result-label">Annual Income:</span>
                    <span class="result-value">${formatNumber(annualIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Coverage Target:</span>
                    <span class="result-value">${healthYears} Year${healthYears > 1 ? 's' : ''}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Target Health Fund:</span>
                    <span class="result-value">${formatNumber(targetHealthFund)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Existing Coverage:</span>
                    <span class="result-value">${formatNumber(existingHealth)}</span>
                </div>
                
                <div class="${gapClass}">
                    <div class="result-item">
                        <span class="result-label">${gapLabel}:</span>
                        <span class="result-value">${formatNumber(gapAmount)}</span>
                    </div>
                </div>
                
                <div class="${isSurplus ? 'surplus-notes' : 'advisor-notes'}">
                    <i class="fas fa-lightbulb"></i> <strong>${isSurplus ? 'Excellent!' : 'Advisor Notes:'}</strong> ${isSurplus ? 
                    'Your client already has ' + formatNumber(gapAmount) + ' more than the recommended health fund. This provides strong protection for medical emergencies.' : 
                    'The fund covers medical costs and replaces income during recovery. Higher multipliers recommended for clients with dependents or family medical history.'}
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Health Care Funding');
        }
        
        function calculateEducation() {
            // Get values from form
            const childAge = parseFloat(document.getElementById('child-age').value);
            const currentTuition = getMonetaryValue('current-tuition');
            const existingEducation = getMonetaryValue('existing-education');
            
            // Get selected college years
            const collegeYears = parseInt(document.querySelector('input[name="college-years"]:checked').value);
            
            // Validate inputs
            if (!childAge || childAge <= 0 || childAge >= 18) {
                alert('Please enter a valid child age (1-17 years).');
                return;
            }
            
            if (!currentTuition || currentTuition <= 0) {
                alert('Please enter a valid current tuition amount.');
                return;
            }
            
            // Calculate years until college (assuming college starts at age 18)
            const yearsUntilCollege = 18 - childAge;
            
            // Calculate future annual tuition with 10% inflation
            const futureAnnualTuition = currentTuition * Math.pow(1.10, yearsUntilCollege);
            
            // Calculate total education fund needed
            const educationFundNeeded = futureAnnualTuition * collegeYears;
            
            // Calculate gap
            const gap = educationFundNeeded - existingEducation;
            const isSurplus = gap < 0;
            const gapAmount = Math.abs(gap);
            const gapLabel = isSurplus ? 'Education Surplus' : 'Education Gap';
            const gapClass = isSurplus ? 'surplus-highlight' : 'gap-highlight';
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 0, maximumFractionDigits: 0});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-graduation-cap"></i> Education Funding ${isSurplus ? 'Surplus' : 'Gap'}
                </div>
                
                <div class="result-item">
                    <span class="result-label">Child's Age:</span>
                    <span class="result-value">${childAge} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Years Until College:</span>
                    <span class="result-value">${yearsUntilCollege} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Current Tuition:</span>
                    <span class="result-value">${formatNumber(currentTuition)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Future Annual Tuition:</span>
                    <span class="result-value">${formatNumber(futureAnnualTuition)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">College Duration:</span>
                    <span class="result-value">${collegeYears} Years</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Total Fund Needed:</span>
                    <span class="result-value">${formatNumber(educationFundNeeded)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Current Savings:</span>
                    <span class="result-value">${formatNumber(existingEducation)}</span>
                </div>
                
                <div class="${gapClass}">
                    <div class="result-item">
                        <span class="result-label">${gapLabel}:</span>
                        <span class="result-value">${formatNumber(gapAmount)}</span>
                    </div>
                </div>
                
                <div class="${isSurplus ? 'surplus-notes' : 'advisor-notes'}">
                    <i class="fas fa-lightbulb"></i> <strong>${isSurplus ? 'Well Done!' : 'Advisor Notes:'}</strong> ${isSurplus ? 
                    'Your client already has ' + formatNumber(gapAmount) + ' more than the projected college cost! This provides excellent education security for their child.' : 
                    'College costs increase ~10% yearly. Starting early allows smaller, regular contributions versus a large lump sum later.'}
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Education Funding');
        }
        
        function calculateRetirement() {
            // Get values from form
            const monthlyRetirement = getMonetaryValue('monthly-retirement');
            const existingRetirement = getMonetaryValue('existing-retirement');
            
            // Get selected multiplier
            const multiplier = parseInt(document.querySelector('input[name="retirement-multiplier"]:checked').value);
            
            // Validate inputs
            if (!monthlyRetirement || monthlyRetirement <= 0) {
                alert('Please enter a valid monthly retirement income.');
                return;
            }
            
            // Calculate annual retirement income
            const annualRetirementIncome = monthlyRetirement * 12;
            
            // Calculate target retirement fund
            const targetRetirementFund = annualRetirementIncome * multiplier;
            
            // Calculate gap
            const gap = targetRetirementFund - existingRetirement;
            const isSurplus = gap < 0;
            const gapAmount = Math.abs(gap);
            const gapLabel = isSurplus ? 'Retirement Surplus' : 'Retirement Gap';
            const gapClass = isSurplus ? 'surplus-highlight' : 'gap-highlight';
            
            // Format numbers with commas for display
            const formatNumber = (num) => {
                return '₱' + num.toLocaleString('en-PH', {minimumFractionDigits: 0, maximumFractionDigits: 0});
            };
            
            // Prepare results HTML
            const resultsHTML = `
                <div class="result-heading">
                    <i class="fas fa-umbrella-beach"></i> Retirement Planning ${isSurplus ? 'Surplus' : 'Gap'}
                </div>
                
                <div class="result-item">
                    <span class="result-label">Monthly Income Goal:</span>
                    <span class="result-value">${formatNumber(monthlyRetirement)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Annual Income Goal:</span>
                    <span class="result-value">${formatNumber(annualRetirementIncome)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Multiplier:</span>
                    <span class="result-value">${multiplier}x</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Target Retirement Fund:</span>
                    <span class="result-value">${formatNumber(targetRetirementFund)}</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Current Savings:</span>
                    <span class="result-value">${formatNumber(existingRetirement)}</span>
                </div>
                
                <div class="${gapClass}">
                    <div class="result-item">
                        <span class="result-label">${gapLabel}:</span>
                        <span class="result-value">${formatNumber(gapAmount)}</span>
                    </div>
                </div>
                
                <div class="${isSurplus ? 'surplus-notes' : 'advisor-notes'}">
                    <i class="fas fa-lightbulb"></i> <strong>${isSurplus ? 'Fantastic!' : 'Advisor Notes:'}</strong> ${isSurplus ? 
                    'Your client already has ' + formatNumber(gapAmount) + ' more than the target retirement fund! This ensures a very comfortable and secure retirement.' : 
                    'The ' + multiplier + 'x multiplier follows the 4% safe withdrawal rule. Starting early maximizes compounding and ensures a comfortable retirement lifestyle.'}
                </div>
            `;
            
            // Display results
            showResults(resultsHTML, 'Retirement Planning');
        }
        
        function showResults(resultsHTML, planningArea) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active-page');
            });
            
            // Set results title
            document.querySelector('#page-results .page-title i').className = getAreaIcon(planningArea);
            document.querySelector('#page-results .page-title').innerHTML = `<i class="${getAreaIcon(planningArea)}"></i> ${planningArea} Results`;
            
            // Insert results into container
            document.getElementById('results-container').innerHTML = resultsHTML;
            
            // Show results page
            document.getElementById('page-results').classList.add('active-page');
            
            // Scroll to top
            document.querySelector('.main-content').scrollTop = 0;
        }
        
        function getAreaIcon(planningArea) {
            switch(planningArea) {
                case 'Income Protection': return 'fas fa-shield-alt';
                case 'Health Care Funding': return 'fas fa-heartbeat';
                case 'Education Funding': return 'fas fa-graduation-cap';
                case 'Retirement Planning': return 'fas fa-umbrella-beach';
                default: return 'fas fa-chart-bar';
            }
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set focus on the first input of each form when page is shown
            document.querySelectorAll('.page').forEach(page => {
                if (page.id !== 'page1' && page.id !== 'page-results') {
                    const firstInput = page.querySelector('input[type="text"], input[type="number"]');
                    if (firstInput) {
                        // Add focus event when page becomes active
                        const observer = new MutationObserver(function(mutations) {
                            mutations.forEach(function(mutation) {
                                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                                    if (page.classList.contains('active-page')) {
                                        setTimeout(() => {
                                            firstInput.focus();
                                        }, 300);
                                    }
                                }
                            });
                        });
                        
                        observer.observe(page, { attributes: true });
                    }
                }
            });
            
            // Handle back button with history (for mobile browsers)
            window.addEventListener('popstate', function() {
                goBackToSelection();
            });
        });
    </script>
</body>
</html>
